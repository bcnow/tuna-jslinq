!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global="undefined"!=typeof globalThis?globalThis:global||self).JSLinq=factory()}(this,function(){"use strict";var JSLinqOrderDirection,JSLinqHelper=function(){function JSLinqHelper(){}return JSLinqHelper.NonEnumerable=function(instance,name,value){Object.defineProperty(instance,name,{value:value,enumerable:!1,configurable:!0})},JSLinqHelper.OrderCompareFunction=function(type_a,value_b_string,type_b,invert){var value_a_string=type_a(value_b_string),value_b_string=type_a(type_b),type_a=typeof value_a_string,type_b=typeof value_b_string;if("string"!=type_a||type_a!=type_b)return"number"!=type_a||type_a!=type_b?"boolean"!=type_a||type_a!=type_b?"undefined"==type_a&&type_a==type_b?0:"undefined"==type_a?invert?1:-1:"undefined"==type_b?invert?-1:1:0:value_a_string===value_b_string?0:!0===invert?value_a_string?1:-1:value_a_string?-1:1:!0===invert?value_b_string-value_a_string:value_a_string-value_b_string;value_a_string=(value_a_string=value_a_string).toLowerCase();return(value_b_string=value_b_string.toLowerCase())<value_a_string?!0===invert?-1:1:value_a_string<value_b_string?!0===invert?1:-1:0},JSLinqHelper}();JSLinqHelper.NonEnumerable(Array.prototype,"Add",function(item){return this.push(item),this}),JSLinqHelper.NonEnumerable(Array.prototype,"AddRange",function(items){var _this=this;return items.ForEach(function(f){return _this.push(f)}),this}),JSLinqHelper.NonEnumerable(Array.prototype,"Aggregate",function(accumulator,initialValue){return this.reduce(accumulator,initialValue)}),JSLinqHelper.NonEnumerable(Array.prototype,"All",function(selector){return this.Count(selector)===this.Count()}),JSLinqHelper.NonEnumerable(Array.prototype,"Any",function(selector){if(!selector)return 0<this.length;var result=!1;return this.ForEach(function(item,index){return result=!0===selector(item,index)}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"Average",function(selector){return this.Sum(selector)/this.Count()}),JSLinqHelper.NonEnumerable(Array.prototype,"Clear",function(){return this.length=0,this}),JSLinqHelper.NonEnumerable(Array.prototype,"Clone",function(){return this.slice(0)}),JSLinqHelper.NonEnumerable(Array.prototype,"Concat",function(array){return this.concat(array)}),JSLinqHelper.NonEnumerable(Array.prototype,"Contains",function(item){return this.Any(function(a){return a===item})}),JSLinqHelper.NonEnumerable(Array.prototype,"Count",function(selector){return(selector?this.Where(selector):this).length}),JSLinqHelper.NonEnumerable(Array.prototype,"Distinct",function(selector){var name_1,result=new Array,groups=this.GroupBy(selector);for(name_1 in groups){var items=groups[name_1];items.Any()&&result.Add(items[0])}return result}),JSLinqHelper.NonEnumerable(Array.prototype,"FindIndex",function(selector){if(!selector)throw new Error("Tuna-JSLinq: You must define a selector");var result=-1;return this.ForEach(function(match,index){match=!0===selector(match,index);return match&&(result=index),match}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"FindLastIndex",function(selector){if(!selector)throw new Error("Tuna-JSLinq: You must define a selector");for(var i=this.length;i--;)if(!0===selector(this[i],i))return i;return-1}),JSLinqHelper.NonEnumerable(Array.prototype,"First",function(result){result=this.FirstOrDefault(result);if(result)return result;throw new Error("Tuna-JSLinq: The First Entry was not found")}),JSLinqHelper.NonEnumerable(Array.prototype,"FirstOrDefault",function(selector){if(!selector)return 0<this.length?this[0]:null;var result=null;return this.ForEach(function(item,match){match=!0===selector(item,match);return match&&(result=item),match}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"ForEach",function(action){for(var length=this.length,i=0;i<length;i++)if(!0===action(this[i],i))break;return this}),JSLinqHelper.NonEnumerable(Array.prototype,"Get",function(result){result=this[result];return void 0===result?null:result}),JSLinqHelper.NonEnumerable(Array.prototype,"GroupBy",function(selector){return this.reduce(function(groups,item){var value=selector?selector(item):item;return groups[value]=groups[value]||[],groups[value].push(item),groups},{})}),JSLinqHelper.NonEnumerable(Array.prototype,"Insert",function(item,index){return this.splice(index,0,item),this}),JSLinqHelper.NonEnumerable(Array.prototype,"Intersect",function(array){return this.Where(function(x){return array.Contains(x)})}),JSLinqHelper.NonEnumerable(Array.prototype,"Join",function(char,selector){var result=this;return selector&&(result=this.Select(selector)),result.join(char)}),JSLinqHelper.NonEnumerable(Array.prototype,"Last",function(result){result=this.LastOrDefault(result);if(result)return result;throw new Error("Tuna-JSLinq: The Last Entry was not found")}),JSLinqHelper.NonEnumerable(Array.prototype,"LastOrDefault",function(selector){if(!selector)return 0<this.length?this[this.length-1]:null;for(var result=null,i=this.length;i--;){var item=this[i];if(!0===selector(item,i)){result=item;break}}return result}),JSLinqHelper.NonEnumerable(Array.prototype,"Max",function(fn){fn=fn||function(item){return item};return this.OrderBy(fn).LastOrDefault()}),JSLinqHelper.NonEnumerable(Array.prototype,"Min",function(fn){fn=fn||function(item){return item};return this.OrderBy(fn).FirstOrDefault()}),JSLinqHelper.NonEnumerable(Array.prototype,"Move",function(from,to){return this.splice(to,0,this.splice(from,1)[0]),this}),JSLinqHelper.NonEnumerable(Array.prototype,"_JSLinq",{Order:void 0}),function(JSLinqOrderDirection){JSLinqOrderDirection[JSLinqOrderDirection.Ascending=0]="Ascending",JSLinqOrderDirection[JSLinqOrderDirection.Descending=1]="Descending"}(JSLinqOrderDirection=JSLinqOrderDirection||{});var JSLinqOrder=function(direction,selector){this.direction=direction,this.selector=selector};JSLinqHelper.NonEnumerable(Array.prototype,"OrderBy",function(selector){var clone=this.Clone();return clone._JSLinq.Order=new Array(new JSLinqOrder(JSLinqOrderDirection.Ascending,selector)),clone.sort(function(a,b){return JSLinqHelper.OrderCompareFunction(selector,a,b,!1)})}),JSLinqHelper.NonEnumerable(Array.prototype,"OrderByDescending",function(selector){var ordered=this.Clone();return ordered._JSLinq.Order=new Array(new JSLinqOrder(JSLinqOrderDirection.Descending,selector)),ordered.sort(function(a,b){return JSLinqHelper.OrderCompareFunction(selector,a,b,!0)})}),JSLinqHelper.NonEnumerable(Array.prototype,"Range",function(start,length){return this.Skip(start).Take(length)}),JSLinqHelper.NonEnumerable(Array.prototype,"Remove",function(index){index=this.indexOf(index);return-1<index&&this.RemoveAt(index),this}),JSLinqHelper.NonEnumerable(Array.prototype,"RemoveAll",function(selector){if(!selector)return this.Clear();for(var i=this.length;i--;)!0===selector(this[i],i)&&this.RemoveAt(i);return this}),JSLinqHelper.NonEnumerable(Array.prototype,"RemoveAt",function(index){return this.splice(index,1),this}),JSLinqHelper.NonEnumerable(Array.prototype,"RemoveRange",function(start,length){var _this=this;return this.Skip(start).Take(length).ForEach(function(f){return _this.Remove(f)}),this}),JSLinqHelper.NonEnumerable(Array.prototype,"Repeat",function(item,count){for(var i=0;i<count;i++)this.Add(item);return this}),JSLinqHelper.NonEnumerable(Array.prototype,"Reverse",function(){return this.reverse()}),JSLinqHelper.NonEnumerable(Array.prototype,"Select",function(selector){var result=new Array;return this.ForEach(function(f,item){item=selector(f,item);result.Add(item)}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"SelectMany",function(selector){var result=new Array;return this.ForEach(function(item,items){items=selector(item,items)||[];result.AddRange(items)}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"SequenceEqual",function(array){if(this===array)return!0;if(this.length!==array.length)return!1;for(var i=0;i<this.length;i++)if(this[i]!==array[i])return!1;return!0}),JSLinqHelper.NonEnumerable(Array.prototype,"Single",function(result){result=result?this.Where(result):this;if(1!==result.Count())throw new Error("Tuna-JSLinq: The array does not contain exactly one element");return result.First()}),JSLinqHelper.NonEnumerable(Array.prototype,"SingleOrDefault",function(selector){return this.Any(selector)?this.Single(selector):null}),JSLinqHelper.NonEnumerable(Array.prototype,"Skip",function(count){return this.slice(count,this.Count())}),JSLinqHelper.NonEnumerable(Array.prototype,"Sum",function(selector){var result=0,fn=selector||function(item){return item};return this.ForEach(function(x){result+=fn(x)}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"Take",function(count){return this.slice(0,count)}),JSLinqHelper.NonEnumerable(Array.prototype,"TakeWhile",function(selector){for(var result=[],length=this.length,i=0;i<length&&!0===selector(this[i],i);)result.push(this[i++]);return result}),JSLinqHelper.NonEnumerable(Array.prototype,"ThenBy",function(selector){var order=this._JSLinq.Order;if(null==order||!order.Any())throw new Error("Tuna-JSLinq: Please call OrderBy or OrderByDescending before ThenBy");return order.Add(new JSLinqOrder(JSLinqOrderDirection.Ascending,selector)),this.sort(function(a,b){for(var _i=0,order_1=order;_i<order_1.length;_i++){var result=order_1[_i],result=JSLinqHelper.OrderCompareFunction(result.selector,a,b,result.direction===JSLinqOrderDirection.Descending);if(0!==result)return result}return 0})}),JSLinqHelper.NonEnumerable(Array.prototype,"ThenByDescending",function(selector){var order=this._JSLinq.Order;if(null==order||!order.Any())throw new Error("Tuna-JSLinq: Please call OrderBy or OrderByDescending before ThenByDescending");return order.Add(new JSLinqOrder(JSLinqOrderDirection.Descending,selector)),this.sort(function(a,b){for(var _i=0,order_1=order;_i<order_1.length;_i++){var result=order_1[_i],result=JSLinqHelper.OrderCompareFunction(result.selector,a,b,result.direction===JSLinqOrderDirection.Descending);if(0!==result)return result}return 0})}),JSLinqHelper.NonEnumerable(Array.prototype,"ToDictionary",function(keySelector,valueSelector){var result=this.GroupBy(keySelector);if(valueSelector)for(var key in result)result[key]=result[key].Select(valueSelector);return result}),JSLinqHelper.NonEnumerable(Array.prototype,"Union",function(array){return this.Concat(array).Distinct()}),JSLinqHelper.NonEnumerable(Array.prototype,"Where",function(selector){if(!selector)throw new Error("Tuna-JSLinq: You must define a selector");var result=new Array;return this.ForEach(function(item,index){!0===selector(item,index)&&result.push(item)}),result}),JSLinqHelper.NonEnumerable(Array.prototype,"Zip",function(array,selector){var result=new Array;return this.ForEach(function(item,index){null!=item&&result.Add(selector(item,array[index]))}),result});return function(array){return array&&!Array.isArray(array)&&(array=[array]),array||[]}});